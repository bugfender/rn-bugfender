const fs = require('fs');
const path = require('path');

const rootDir = path.resolve(__dirname, '..');
const versionFile = path.join(rootDir, 'sdk-version.json');
const headerFile = path.join(rootDir, 'ios', 'SDKVersion.h');

// Read version from JSON file
const versionData = JSON.parse(fs.readFileSync(versionFile, 'utf8'));
const version = versionData.version;

// Generate header file
const headerContent = `//
// This file is auto-generated by scripts/generate-sdk-version-header.js
// Do not edit manually. Update sdk-version.json instead.
//

#ifndef SDK_VERSION_H
#define SDK_VERSION_H

static const int SDK_VERSION = ${version};

#endif /* SDK_VERSION_H */
`;

fs.writeFileSync(headerFile, headerContent, 'utf8');
console.log(`Generated ${headerFile} with SDK_VERSION = ${version}`);
